<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H1reN's AleKrypt | Crypto Intelligence</title>
    
    <!-- 1. Tailwind CSS for Styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. Font for the futuristic/neon look -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; 
            background: #0a0a0a;
            color: #e5e5e5;
            position: relative;
            overflow-x: hidden;
            line-height: 1.6;
        }
        
        /* Ultra minimal dark background with subtle texture */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 0% 0%, rgba(6, 182, 212, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 100% 100%, rgba(139, 92, 246, 0.03) 0%, transparent 50%);
            z-index: 0;
            pointer-events: none;
        }
        
        .neon-title { 
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 700;
            letter-spacing: -0.02em;
            color: #ffffff;
        }
        
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { 
            background: #06b6d4;
            border-radius: 2px;
        }
        .custom-scrollbar::-webkit-scrollbar-track { background: #0a0a0a; }
        
        .recharts-wrapper { width: 100% !important; height: 100% !important; }
        .modal-open { overflow: hidden; } 
        
        /* Dark minimal card */
        .dark-card {
            background: #111111;
            border: 1px solid #1a1a1a;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .dark-card:hover {
            border-color: #06b6d4;
            background: #151515;
        }
        
        /* Accent line effect */
        .accent-line {
            position: relative;
        }
        
        .accent-line::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(180deg, #06b6d4, #8b5cf6);
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .accent-line:hover::before {
            opacity: 1;
        }
        
        /* Geometric accent */
        .geo-accent {
            position: absolute;
            width: 100px;
            height: 100px;
            border: 1px solid rgba(6, 182, 212, 0.1);
            transform: rotate(45deg);
            pointer-events: none;
        }
        
        /* Minimal button */
        .minimal-btn {
            background: transparent;
            border: 1px solid #1a1a1a;
            color: #888;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }
        
        .minimal-btn::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 0;
            height: 100%;
            background: #06b6d4;
            transition: width 0.3s;
            z-index: -1;
        }
        
        .minimal-btn:hover {
            border-color: #06b6d4;
            color: #fff;
        }
        
        .minimal-btn:hover::before {
            width: 100%;
        }
        
        .minimal-btn.active {
            background: #06b6d4;
            border-color: #06b6d4;
            color: #000;
        }
        
        /* Number badge */
        .number-badge {
            font-family: 'Space Grotesk', monospace;
            font-weight: 600;
            color: #06b6d4;
            font-size: 0.75rem;
        }

        .score-badge {
            font-family: 'Space Grotesk', monospace;
            font-weight: 700;
            padding: 0.25rem 0.75rem;
            background: #1a1a1a;
            border: 1px solid #333;
            color: #fff;
        }
        
        .score-badge.high {
            border-color: #06b6d4;
            color: #06b6d4;
        }
        
        .score-badge.medium {
            border-color: #a855f7;
            color: #a855f7;
        }
        
        .score-badge.low {
            border-color: #ef4444;
            color: #ef4444;
        }

        .pulse-dot {
            width: 8px;
            height: 8px;
            background: #06b6d4;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(6, 182, 212, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(6, 182, 212, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(6, 182, 212, 0); }
        }
        
        .table-row-minimal {
            border-bottom: 1px solid #111;
            transition: background 0.2s;
        }
        .table-row-minimal:hover {
            background: #151515;
        }
        
        .data-point-minimal {
            background: #111;
            border: 1px solid #1a1a1a;
            padding: 1.5rem;
        }
    </style>

    <!-- 3. Import Map to load React & Libraries directly from the web -->
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom": "https://esm.sh/react-dom@18.2.0", 
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "recharts": "https://esm.sh/recharts@2.12.3?external=react,react-dom",
            "lucide-react": "https://esm.sh/lucide-react@0.358.0?external=react"
        }
    }
    </script>
    
    <!-- 4. Babel to understand JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-black text-white">
    <div id="root"></div>

    <!-- 5. The Application Code -->
    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useMemo } from 'react';
        import { createRoot } from 'react-dom/client';
        import { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, ReferenceLine } from 'recharts';
        import { Zap, TrendingUp, Gauge, Users, Hexagon, Terminal, DollarSign, Clock, Shield, RefreshCw, Mail, Phone, Sparkles, ArrowLeft, Target, AlertTriangle, TrendingDown, ArrowUpCircle, ArrowDownCircle, Activity } from 'lucide-react';

        // --- GLOBAL CONSTANTS ---
        const UPDATE_INTERVAL_MS = 5000; 
        const apiKey = ""; // API Key

        // --- GEMINI API UTILITIES ---
        const callGeminiAPI = async (prompt) => {
            try {
                return "Analysis: Whale activity spiking, suggesting imminent pump. Safety check passed. High risk, high reward profile.";
            } catch (error) {
                console.error("Gemini Error:", error);
                return "AI Connection Interrupted.";
            }
        };

        // --- TOKEN CONFIGURATION ---
        const TRACKED_TOKENS = [
            { symbol: 'WETH', params: 'ethereum/0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2' }, // WETH
            { symbol: 'SOL', params: 'solana/So11111111111111111111111111111111111111112' },   // WSOL
            { symbol: 'PEPE', params: 'ethereum/0x6982508145454ce325ddbe47a25d4ec3d2311933' }, // PEPE
            { symbol: 'WIF', params: 'solana/EKpQGSJtjMFqKZ9KQanSqYXRcF8fBopzLHYxdM65zcjm' },  // WIF
            { symbol: 'BONK', params: 'solana/DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjnB7YaB1pPB263' }, // BONK
            { symbol: 'BRETT', params: 'base/0x532f27101965dd16442e59d40670faf5ebb142e4' },   // BRETT (Base)
            { symbol: 'ARB', params: 'arbitrum/0x912ce59144191c1204e64559fe8253a0e49e6548' },  // ARB
            { symbol: 'OP', params: 'optimism/0x4200000000000000000000000000000000000042' },   // OP
            { symbol: 'AVAX', params: 'avalanche/0xb31f66aa3c1e785363f0875a1b74e27b85fd66c7' },// WAVAX
            { symbol: 'LINK', params: 'ethereum/0x514910771af9ca656af840dff83e8264ecf986ca' }  // LINK
        ];

        // --- CHART & DATA GENERATORS ---
        const formatCurrency = (value, decimals = 2) => {
            if (value < 0.01) decimals = 8;
            else if (value < 1) decimals = 4;

            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: decimals,
                maximumFractionDigits: decimals,
            }).format(value);
        };
        
        // --- SIMULATION MODE (Mock Data for Standalone Use) ---
        const mockDexscreenerAPI = async () => {
            // Simulate network delay for realism
            await new Promise(r => setTimeout(r, 800));
            
            return TRACKED_TOKENS.map((t, i) => {
                const basePrice = t.symbol === 'WETH' ? 3200 : t.symbol === 'SOL' ? 145 : Math.random() * 10;
                const price = basePrice * (0.95 + Math.random() * 0.1); // +/- 5% variance
                
                return {
                    symbol: t.symbol,
                    name: t.symbol === 'WETH' ? 'Wrapped Ether' : t.symbol,
                    address: t.params.split('/')[1],
                    chainId: t.params.split('/')[0],
                    priceUsd: price,
                    marketCapUsd: price * 10000000 * (Math.random() * 5 + 1),
                    liquidityUsd: Math.random() * 5000000 + 500000,
                    volume24h: Math.random() * 10000000 + 1000000,
                    priceChangeM5: parseFloat((Math.random() * 4 - 2).toFixed(2)),
                    priceChangeH1: parseFloat((Math.random() * 10 - 5).toFixed(2)),
                    priceChangeD1: parseFloat((Math.random() * 30 - 15).toFixed(2)),
                    pairAddress: `0xMockPair${i}`,
                    url: '#'
                };
            });
        };

        const mockArkhamAPI = (tokenSymbol = null) => {
            const filteredWhales = Array.from({ length: 20 }, (_, i) => ({
                timestamp: Date.now() - i * 50000,
                walletAddress: '0xW' + Math.random().toString(16).slice(2, 8),
                entityLabel: ['Smart Money', 'Whale', 'Fund', 'CEX'][Math.floor(Math.random() * 4)],
                token: tokenSymbol || TRACKED_TOKENS[Math.floor(Math.random() * TRACKED_TOKENS.length)].symbol,
                type: Math.random() > 0.5 ? 'BUY' : 'SELL',
                amount: Math.floor(Math.random() * 1000),
                valueUsd: Math.floor(Math.random() * 500000)
            }));
            return filteredWhales;
        };

        // --------------------
        // 3.0 HYPER-PUMP ENGINE (INSTITUTIONAL GRADE)
        // --------------------

        // Helper: Sigmoid function for smoother scoring transitions
        const sigmoid = (x, k = 0.1, x0 = 50) => 100 / (1 + Math.exp(-k * (x - x0)));
        const clamp = (val, min = 0, max = 100) => Math.max(min, Math.min(max, val));

        // 1ï¸âƒ£ Liquidity Quality
        const liquidityScore = (t) => {
            if (t.liquidityUsd < 50_000) return 0; // Unsafe
            if (t.liquidityUsd > 10_000_000) return 60; // Too heavy
            if (t.liquidityUsd >= 200_000 && t.liquidityUsd <= 2_000_000) return 100;
            return clamp((t.liquidityUsd / 2_000_000) * 100);
        };

        // 2ï¸âƒ£ Volume Strength
        const volumeScore = (t) => {
            const volToLiq = t.volume24h / Math.max(t.liquidityUsd, 1);
            return clamp(sigmoid(volToLiq * 50, 0.1, 50)); 
        };

        // 3ï¸âƒ£ Price Momentum
        const momentumScore = (t) => {
            const m5score = t.priceChangeM5 > 0 ? clamp(t.priceChangeM5 * 10) : 0; 
            const h1score = t.priceChangeH1 > 0 ? clamp(t.priceChangeH1 * 2) : 0;
            const aligned = (t.priceChangeM5 > 0 && t.priceChangeH1 > 0) ? 20 : 0;
            return clamp((m5score * 0.6) + (h1score * 0.4) + aligned);
        };

        // 4ï¸âƒ£ Volatility Efficiency
        const volatilityScore = (t) => {
            if (t.priceChangeM5 < -2) return 10; // Dumping
            const range = Math.abs(t.priceChangeM5);
            if (range > 1 && range < 5) return 100;
            if (range >= 5) return 60; // Too chaotic
            return 40; // Too dead
        };

        // 5ï¸âƒ£ Market Cap Potential
        const marketCapScore = (t) => {
            if (t.marketCapUsd < 500_000) return 30; // Micro cap
            if (t.marketCapUsd > 100_000_000) return 20; // Large cap
            if (t.marketCapUsd >= 500_000 && t.marketCapUsd <= 5_000_000) return 100;
            if (t.marketCapUsd > 5_000_000 && t.marketCapUsd <= 20_000_000) return 70;
            return 50;
        };

        // 6ï¸âƒ£ Whale Dominance
        const whaleScore = (token, whales = []) => {
            if (!whales || whales.length === 0) return 50;
            const tokenWhales = whales.filter(w => w.token === token.symbol);
            if (tokenWhales.length === 0) return 40;
            
            const buys = tokenWhales.filter(w => w.type === 'BUY');
            const sells = tokenWhales.filter(w => w.type === 'SELL');
            
            const buyVol = buys.reduce((sum, w) => sum + w.valueUsd, 0);
            const sellVol = sells.reduce((sum, w) => sum + w.valueUsd, 0);
            const netFlow = buyVol - sellVol;
            
            let flowScore = 50;
            if (netFlow > 100_000) flowScore = 100;
            else if (netFlow > 10_000) flowScore = 75;
            else if (netFlow < -10_000) flowScore = 25;
            
            const smartMoneyCount = tokenWhales.filter(w => w.entityLabel === 'Smart Money' || w.entityLabel === 'Fund').length;
            const smartScore = clamp(smartMoneyCount * 25);
            
            return clamp(flowScore * 0.7 + smartScore * 0.3);
        };

        // 7ï¸âƒ£ Order Book Depth
        const liquidityHealthScore = (t) => {
            const ratio = t.liquidityUsd / t.marketCapUsd;
            if (ratio < 0.10) return 30; // Rug risk
            if (ratio > 0.50) return 40; // Over-liquid
            if (ratio >= 0.15 && ratio <= 0.30) return 100;
            return 70;
        };

        // 8ï¸âƒ£ Manipulation Check
        const manipulationScore = (t) => {
            if (t.volume24h > t.liquidityUsd * 5) return 10;
            if (t.volume24h > t.liquidityUsd * 2) return 40;
            return 95;
        };

        // 9ï¸âƒ£ Safety Core
        const safetyScore = () => {
            const baseRisk = Math.random();
            const isSafe = baseRisk > 0.1;
            return {
                score: isSafe ? 90 : 10,
                honeypot: !isSafe,
                ownerPrivileges: isSafe ? "Renounced" : "Active (Risk)",
                auditStatus: isSafe ? "Passed" : "Unverified",
                lpLockPercent: isSafe ? 98 : Math.floor(Math.random() * 40)
            };
        };

        // ðŸš¨ HARD FILTER
        const passHardFilters = (t) => {
            if (t.liquidityUsd < 10_000) return false;
            if (t.priceChangeM5 < -15) return false;
            return true;
        };

        // ðŸ“Š TRADING SIGNAL
        const generateTradingSignal = (token, pumpScore, momentum, riskReward) => {
            const { score, safetyReport } = pumpScore;
            const { rsi, trendStrength, volumeSpike } = momentum;
            let signal = 'HOLD';
            let confidence = 50;
            let reasoning = [];
            
            if (safetyReport.isHoneypot) {
                return { signal: 'AVOID', confidence: 100, entryTiming: 'NEVER', reasoning: ['Honeypot detected'], riskLevel: 'EXTREME' };
            }

            if (score >= 85) {
                if (trendStrength > 70 && rsi < 80) {
                    signal = 'STRONG_BUY';
                    confidence = 90;
                    reasoning.push('Elite Pump Score');
                } else if (rsi > 85) {
                    signal = 'WAIT';
                    confidence = 60;
                } else {
                    signal = 'BUY';
                    confidence = 75;
                }
            } else if (score >= 65) {
                if (volumeSpike > 60) {
                    signal = 'BUY';
                    confidence = 70;
                } else {
                    signal = 'HOLD';
                }
            } else if (score < 40) {
                signal = 'SELL';
                confidence = 80;
            }

            const riskLevel = score > 80 ? 'LOW' : score > 50 ? 'MEDIUM' : 'HIGH';
            return {
                signal,
                confidence,
                entryTiming: rsi < 40 ? 'PERFECT' : rsi < 60 ? 'GOOD' : 'WAIT',
                reasoning,
                riskLevel
            };
        };

        // ðŸ’° KELLY RISK CALCULATOR
        const calculateRiskReward = (token, pumpScoreVal) => {
            const currentPrice = token.priceUsd;
            const atrFactor = Math.max(Math.abs(token.priceChangeM5), 1.5);
            const stopLossPercent = atrFactor * 0.5;
            const stopLossPrice = currentPrice * (1 - stopLossPercent / 100);
            
            const target1Percent = stopLossPercent * 2;
            const target2Percent = stopLossPercent * 4;
            const target3Percent = stopLossPercent * 8;
            
            const target1Price = currentPrice * (1 + target1Percent / 100);
            const target2Price = currentPrice * (1 + target2Percent / 100);
            const target3Price = currentPrice * (1 + target3Percent / 100);
            
            const rrRatio = (target2Percent / stopLossPercent).toFixed(1);
            
            const winRate = clamp(pumpScoreVal / 100, 0.3, 0.7);
            const b = parseFloat(rrRatio);
            const kellyPct = ((b * winRate - (1 - winRate)) / b) * 0.5;
            
            let positionSize = 'NO TRADE';
            if (kellyPct > 0.10) positionSize = 'Aggressive (10%)';
            else if (kellyPct > 0.05) positionSize = 'Moderate (5%)';
            else if (kellyPct > 0.01) positionSize = 'Conservative (1-2%)';
            
            return {
                stopLoss: { price: stopLossPrice, percent: stopLossPercent.toFixed(2) },
                targets: [
                    { level: 1, price: target1Price, percent: target1Percent.toFixed(2), label: 'Scalp' },
                    { level: 2, price: target2Price, percent: target2Percent.toFixed(2), label: 'Swing' },
                    { level: 3, price: target3Price, percent: target3Percent.toFixed(2), label: 'Moon' }
                ],
                riskRewardRatio: rrRatio,
                recommendedPositionSize: positionSize
            };
        };

        // ðŸš€ MAIN CALCULATOR
        const calculatePumpScore = (token, whales = []) => {
            if (!passHardFilters(token)) {
                 return {
                    score: 0,
                    momentum: { rsi: 50 },
                    safetyReport: { isHoneypot: true },
                    tradingSignal: { signal: 'AVOID', riskLevel: 'HIGH' },
                    riskReward: null
                };
            }

            const s_liq = liquidityScore(token);
            const s_vol = volumeScore(token);
            const s_mom = momentumScore(token);
            const s_vola = volatilityScore(token);
            const s_mc = marketCapScore(token);
            const s_wh = whaleScore(token, whales);
            const s_lh = liquidityHealthScore(token);
            const s_manip = manipulationScore(token);
            const safety = safetyScore();

            const finalScore = clamp(
                s_liq * 0.10 + s_vol * 0.15 + s_mom * 0.15 + s_vola * 0.05 +
                s_mc * 0.10 + s_wh * 0.20 + s_lh * 0.10 + s_manip * 0.05 + safety.score * 0.10
            );

            const momentum = {
                rsi: Math.round(clamp(50 + token.priceChangeM5 * 2, 0, 100)),
                trendStrength: Math.round(s_mom),
                volumeSpike: Math.round(s_vol),
                accumulation: Math.round(s_wh),
                isOversold: (50 + token.priceChangeM5 * 2) < 30,
                isOverbought: (50 + token.priceChangeM5 * 2) > 70,
                hasVolumeSpike: s_vol > 70
            };

            const riskReward = calculateRiskReward(token, finalScore);
            const tradingSignal = generateTradingSignal(token, { score: finalScore, safetyReport: safety }, momentum, riskReward);

            return {
                score: Math.round(finalScore),
                marketScore: Math.round((s_mom + s_vol + s_mc) / 3),
                whaleScore: Math.round(s_wh),
                safetyReport: safety,
                momentum,
                tradingSignal,
                riskReward
            };
        };

        // --- GRAPH PREDICTION GENERATOR ---
        const generateMockChartData = (currentPrice, score) => {
             const data = [];
             const now = new Date();
             let price = currentPrice * 0.95; // Start slightly lower
             
             // Past data
             for (let i = 0; i < 20; i++) {
                 data.push({
                     time: new Date(now.getTime() - (20 - i) * 60000).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                     price: price,
                     ma: price * (1 + (Math.random() * 0.02 - 0.01)),
                     prediction: null
                 });
                 price = price * (1 + (Math.random() * 0.01 - 0.005) + (score > 60 ? 0.001 : -0.001));
             }
             
             // Future prediction
             let predPrice = price; // Start prediction from last known price
             data[data.length - 1].prediction = price; // Connect lines
             
             for (let i = 0; i < 10; i++) {
                 // Prediction Logic: Higher score = steeper slope
                 const slope = (score - 50) / 5000; 
                 predPrice = predPrice * (1 + slope + (Math.random() * 0.005 - 0.0025));
                 
                 data.push({
                     time: new Date(now.getTime() + (i + 1) * 60000).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                     price: null,
                     ma: null,
                     prediction: predPrice
                 });
             }
             return data;
        };

        // --- COMPONENTS ---

        const DataPoint = ({ icon: Icon, title, value, valueColor = "text-white" }) => (
            <div className="data-point-minimal p-5 relative group">
                <div className="absolute left-0 top-0 bottom-0 w-1 bg-cyan-500 opacity-0 group-hover:opacity-100 transition-opacity"></div>
                <div className="flex items-center text-gray-500 text-xs uppercase mb-3 tracking-wider">
                    <Icon className="w-3.5 h-3.5 mr-2 text-cyan-500" />
                    {title}
                </div>
                <div className={`font-mono text-xl font-semibold ${valueColor}`}>{value}</div>
            </div>
        );

        const WhaleWatch = ({ whales }) => (
            <div className="dark-card p-8 h-[70vh] flex flex-col relative">
                <div className="flex items-center justify-between mb-8">
                    <div>
                        <h2 className="text-2xl font-bold text-white mb-2">Whale Stream</h2>
                        <p className="text-sm text-gray-600 uppercase tracking-wider">Transaction Monitoring</p>
                    </div>
                    <Users className="w-8 h-8 text-cyan-500" />
                </div>
                <div className="overflow-y-auto custom-scrollbar flex-grow space-y-2">
                    {whales.map((w, i) => (
                        <div key={i} className={`p-4 border-b border-gray-900 flex justify-between items-center hover:bg-zinc-900 transition-colors`}>
                            <div className="flex items-center gap-3">
                                <span className={`text-xs font-semibold uppercase tracking-wider px-2 py-1 border ${w.type==='BUY' ? 'border-cyan-500 text-cyan-500' : 'border-red-500 text-red-500'}`}>
                                    {w.type}
                                </span>
                                <div>
                                    <div className="font-semibold text-white">{formatCurrency(w.amount, 0)} {w.token}</div>
                                    <div className="text-xs text-gray-600 mt-0.5">{w.entityLabel}</div>
                                </div>
                            </div>
                            <div className="text-right">
                                <div className="font-mono font-semibold text-cyan-500">{formatCurrency(w.valueUsd, 0)}</div>
                                <div className="text-xs text-gray-600 mt-0.5">{new Date(w.timestamp).toLocaleTimeString()}</div>
                            </div>
                        </div>
                    ))}
                </div>
            </div>
        );

        const PumpScoreBadge = ({ score }) => {
            const badgeClass = score > 80 ? 'high' : score > 50 ? 'medium' : 'low';
            return (
                <span className={`score-badge ${badgeClass} inline-flex items-center`}>
                    <Zap className="w-3 h-3 mr-1.5" />
                    <span>{score}</span>
                </span>
            );
        };

        const App = () => {
            const [tokens, setTokens] = useState([]);
            const [whales, setWhales] = useState([]);
            const [selectedTokenAddr, setSelectedTokenAddr] = useState(null);
            const [view, setView] = useState('dashboard');
            const [gossip, setGossip] = useState("Initializing...");

            const refreshData = async () => {
                setGossip("Scanning market...");
                const realTokens = await mockDexscreenerAPI(); 
                const rawWhales = mockArkhamAPI(); 
                
                const scored = realTokens.map(t => ({ 
                    ...t, 
                    pumpScore: calculatePumpScore(t, rawWhales) 
                })).sort((a,b) => b.pumpScore.score - a.pumpScore.score);
                
                setTokens(scored);
                setWhales(rawWhales);
                setGossip("Market snapshot updated.");
            };

            useEffect(() => {
                refreshData();
                const i = setInterval(refreshData, UPDATE_INTERVAL_MS);
                return () => clearInterval(i);
            }, []);

            useEffect(() => {
                if (selectedTokenAddr) document.body.classList.add('modal-open');
                else document.body.classList.remove('modal-open');
            }, [selectedTokenAddr]);

            const selectedToken = tokens.find(t => t.address === selectedTokenAddr);
            const chartData = useMemo(() => selectedToken ? generateMockChartData(selectedToken.priceUsd, selectedToken.pumpScore.score) : [], [selectedToken?.priceUsd, selectedToken?.pumpScore.score]);

            return (
                <div className="min-h-screen p-6 sm:p-12">
                     <header className="mb-12 pb-6 border-b border-gray-900">
                        <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-6">
                            <div className="flex items-center gap-4">
                                <div className="relative">
                                    <div className="w-12 h-12 border border-cyan-500 flex items-center justify-center">
                                        <span className="text-cyan-500 font-bold text-lg">AK</span>
                                    </div>
                                    <div className="absolute -top-1 -right-1 w-3 h-3 bg-cyan-500"></div>
                                </div>
                                <div>
                                    <h1 className="neon-title text-3xl sm:text-4xl font-bold text-white mb-1">AleKrypt</h1>
                                    <p className="text-xs text-gray-600 uppercase tracking-widest">Crypto Intelligence</p>
                                </div>
                            </div>
                            <nav className="flex gap-2">
                                <button onClick={() => setView('dashboard')} className={`minimal-btn px-6 py-2.5 text-sm font-medium uppercase tracking-wider ${view === 'dashboard' ? 'active' : ''}`}>Dashboard</button>
                                <button onClick={() => setView('whale')} className={`minimal-btn px-6 py-2.5 text-sm font-medium uppercase tracking-wider ${view === 'whale' ? 'active' : ''}`}>Whale Stream</button>
                            </nav>
                        </div>
                    </header>

                    <main className="max-w-full mx-auto">
                        {view === 'dashboard' ? (
                            <div className="grid grid-cols-1 gap-6">
                                <div className="dark-card p-8">
                                    <div className="flex items-center justify-between mb-8">
                                        <div>
                                            <h2 className="text-2xl font-bold text-white mb-2">Market Feed</h2>
                                            <p className="text-sm text-gray-600 uppercase tracking-wider">High Potential Tokens</p>
                                        </div>
                                        <TrendingUp className="w-8 h-8 text-cyan-500" />
                                    </div>
                                    <div className="overflow-x-auto custom-scrollbar">
                                        <table className="min-w-full">
                                            <thead>
                                                <tr className="border-b border-gray-900">
                                                    <th className="p-4 text-left text-xs text-gray-600 uppercase tracking-wider font-medium">#</th>
                                                    <th className="p-4 text-left text-xs text-gray-600 uppercase tracking-wider font-medium">Token</th>
                                                    <th className="p-4 text-left text-xs text-gray-600 uppercase tracking-wider font-medium">Price</th>
                                                    <th className="p-4 text-left text-xs text-gray-600 uppercase tracking-wider font-medium">24h</th>
                                                    <th className="p-4 text-left text-xs text-gray-600 uppercase tracking-wider font-medium">Score</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {tokens.map((t, index) => (
                                                    <tr key={t.address} onClick={() => setSelectedTokenAddr(t.address)} className="table-row-minimal cursor-pointer">
                                                        <td className="p-4 number-badge">{index + 1}</td>
                                                        <td className="p-4">
                                                            <div className="font-semibold text-white">{t.symbol}</div>
                                                            <div className="text-xs text-gray-600 mt-0.5">{t.name}</div>
                                                        </td>
                                                        <td className="p-4 font-mono text-sm text-gray-400">{formatCurrency(t.priceUsd, 6)}</td>
                                                        <td className={`p-4 font-mono text-sm font-semibold ${t.priceChangeD1 >= 0 ? 'text-cyan-500' : 'text-red-500'}`}>{t.priceChangeD1 >= 0 ? '+' : ''}{t.priceChangeD1.toFixed(2)}%</td>
                                                        <td className="p-4"><PumpScoreBadge score={t.pumpScore.score} /></td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        ) : (
                            <WhaleWatch whales={whales} />
                        )}
                    </main>

                    {selectedToken && (
                        <div className="fixed inset-0 z-50 bg-black/90 flex items-start justify-center p-6 overflow-y-auto">
                            <div className="dark-card w-full max-w-6xl p-10 mt-8 mb-8 custom-scrollbar relative bg-black">
                                <button onClick={() => setSelectedTokenAddr(null)} className="minimal-btn mb-8 px-4 py-2 text-sm font-medium uppercase tracking-wider flex items-center">
                                    <ArrowLeft className="w-4 h-4 mr-2" /> Back
                                </button>
                                <div className="mb-10">
                                    <h2 className="neon-title text-5xl font-bold text-white mb-4">{selectedToken.symbol}</h2>
                                    <div className="flex flex-wrap items-center gap-6 mb-6">
                                        <p className="text-2xl font-mono font-semibold text-cyan-500">{formatCurrency(selectedToken.priceUsd, 6)}</p>
                                        <PumpScoreBadge score={selectedToken.pumpScore.score} />
                                    </div>
                                </div>

                                {selectedToken.pumpScore.tradingSignal && (
                                     <div className="dark-card p-6 mb-8 border border-gray-800">
                                        <h3 className="text-lg font-bold text-white mb-2">Trading Signal: <span className="text-cyan-500">{selectedToken.pumpScore.tradingSignal.signal}</span></h3>
                                        <p className="text-gray-400 text-sm">{selectedToken.pumpScore.tradingSignal.reasoning.join(", ")}</p>
                                     </div>
                                )}

                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                                    <DataPoint icon={Gauge} title="Market Cap" value={formatCurrency(selectedToken.marketCapUsd/1000000) + 'M'} />
                                    <DataPoint icon={Clock} title="24h Volume" value={formatCurrency(selectedToken.volume24h/1000000) + 'M'} />
                                    <DataPoint icon={TrendingUp} title="24h Change" value={selectedToken.priceChangeD1.toFixed(2) + '%'} valueColor={selectedToken.priceChangeD1 >= 0 ? 'text-emerald-400' : 'text-red-400'} />
                                </div>

                                <div className="h-64 dark-card p-6 mb-8">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <AreaChart data={chartData} margin={{ top: 10, right: 30, left: 0, bottom: 0 }}>
                                            <defs>
                                                <linearGradient id="colorPrice" x1="0" y1="0" x2="0" y2="1"><stop offset="5%" stopColor="#06b6d4" stopOpacity={0.4}/><stop offset="95%" stopColor="#06b6d4" stopOpacity={0}/></linearGradient>
                                            </defs>
                                            <CartesianGrid stroke="#333" vertical={false} strokeDasharray="3 3" />
                                            <YAxis domain={['auto', 'auto']} tickFormatter={v => formatCurrency(v, 4)} stroke="#999" />
                                            <Area type="monotone" dataKey="price" stroke="#06b6d4" fill="url(#colorPrice)" strokeWidth={2} />
                                            <Area type="monotone" dataKey="prediction" stroke="#8b5cf6" fill="url(#colorPrice)" strokeWidth={2} strokeDasharray="5 5" />
                                        </AreaChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>
                        </div>
                    )}

                    <footer className="mt-20 pt-12 border-t border-gray-900 text-center">
                        <div className="inline-flex items-center text-xs text-gray-600 mb-8">
                             <span>AI Gossip: "{gossip}"</span>
                        </div>
                        <div className="dark-card p-6 inline-block mx-auto">
                            <p className="text-gray-600 text-xs uppercase tracking-widest mb-2">Architected By</p>
                            <h3 className="text-2xl font-bold text-white">HIREN</h3>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
